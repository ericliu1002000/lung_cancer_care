{% extends "layouts/base_portal.html" %}

{% block title %}健康档案{% endblock %}

{% block body %}
<div class="min-h-screen bg-[#F5F5F5] font-sans pb-10">
    
    <!-- Top Header -->
    <div class="bg-white sticky top-0 z-30 shadow-sm">
        <div class="pt-safe-top">
            <div class="flex items-center h-12 px-4 relative">
                <a href="javascript:void(0)" onclick="goHomeReplace()" class="absolute left-4 p-2 -ml-2 text-slate-600 active:opacity-60">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </a>
                <h1 class="w-full text-center text-lg font-bold text-slate-800">健康档案</h1>
            </div>
        </div>
    </div>

    <div class="px-4 pt-6">
        
        {% if health_stats %}
        <div class="bg-white rounded-xl shadow-sm overflow-hidden divide-y divide-slate-100">
            {% for stat in health_stats %}
            <div class="p-4 flex items-center justify-between active:bg-slate-50 transition">
                <div class="flex items-start gap-3">
                    <!-- Icon -->
                    <div class="w-6 h-6 flex items-center justify-center text-blue-600 mt-0.5">
                        {% if stat.icon == 'temperature' %}
                        <svg
                            t="1765679517010"
                            class="icon w-6 h-6"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="24205"
                            width="32"
                            height="32"
                        >
                            <path
                            d="M846.611917 85.510536c-59.643402-39.140439-139.895167-22.38994-178.919972 37.309744L341.052606 622.593817c-7.867178 12.038174-11.592013 31.724539-8.668427 45.816488l20.085454 96.674806L266.953981 895.961882c-12.363585 18.891256-7.082302 44.254923 11.799744 56.646138 18.885116 12.390191 44.193525 7.113001 56.561204-11.778254l84.470857-129.270179 99.121532-20.745487c14.048971-2.960425 30.577413-14.245446 38.444591-26.282596l326.637292-499.773538C923.014005 205.057259 906.247132 124.651998 846.611917 85.510536zM866.518293 253.290797 539.881001 753.064334c-4.828982 7.399527-16.636912 15.46932-25.25929 17.267269L390.907061 796.223297c-2.734274 0.569982-5.499248 0.047072-7.839549-1.474584-2.320858-1.542122-3.921309-3.879354-4.489244-6.603395l-25.749454-123.968429c-1.805112-8.654101 0.867764-22.718421 5.689582-30.116925l326.643432-499.774561c32.712029-50.059116 100.024088-64.095807 150.015665-31.28247C885.185444 135.813199 899.246695 203.243961 866.518293 253.290797zM774.693957 194.285938c-38.542828-25.302269-90.436732-14.480806-115.656113 24.118304l-14.263865 21.825075 37.60241 24.663726c7.603165 4.997827 9.743922 15.259542 4.780887 22.892383-4.999874 7.610328-15.249309 9.748015-22.858614 4.76656l-37.59013-24.681122-51.584865 78.9317 37.601386 24.662703c7.615445 5.01113 9.751085 15.258519 4.770653 22.87908-4.980431 7.621585-15.216563 9.756201-22.817682 4.774747l-37.615713-24.692379-51.577702 78.929654 37.589107 24.681122c3.704368 2.425236 6.230911 6.134721 7.123234 10.45205 0.902556 4.330632 0.069585 8.741082-2.351558 12.42703-4.981455 7.621585-15.232936 9.759271-22.838148 4.761444l-37.59627-24.679076-51.577702 78.929654 37.594223 24.664749c3.697205 2.426259 6.235005 6.149047 7.126304 10.467399 0.900509 4.316306 0.069585 8.741082-2.344395 12.426007-4.983501 7.606235-15.226796 9.741875-22.839171 4.747117L417.768849 587.568093l-10.570753 16.173354c-3.721765 5.705955-5.783727 16.544815-4.384867 23.214724l19.85214 95.576799c0.440022 2.113127 1.674129 3.919263 3.461845 5.105275 1.799996 1.167592 3.935636 1.572822 6.043646 1.1328l95.385441-19.953448c6.650467-1.38658 15.748682-7.614421 19.470447-13.319353l251.835655-385.320832C824.095088 271.575232 813.253158 219.583091 774.693957 194.285938z"
                            fill="#01B695"
                            p-id="24206"
                            ></path>
                            <path
                            d="M176.23277 179.806155c18.10024-1.804089 28.052916-11.755742 29.877471-29.877471-1.824555-17.188474-11.777231-26.694989-29.877471-28.519544-17.20894 1.824555-26.715455 11.33107-28.519544 28.519544C149.517315 168.050414 159.02383 178.002067 176.23277 179.806155L176.23277 179.806155zM176.23277 94.247524c34.397415 3.628644 53.410444 22.195511 57.039087 55.68116-3.628644 34.418904-22.641673 53.431933-57.039087 57.039087-33.506115-3.607154-52.072983-22.620184-55.68116-57.039087C124.159788 116.444059 142.727679 97.876168 176.23277 94.247524L176.23277 94.247524zM345.991082 110.544699c47.977711 2.715855 72.868611 15.405875 74.694189 38.026058-0.912789 14.493086-8.148587 22.195511-21.728884 23.086811-3.628644 0-9.060353-1.357927-16.297175-4.074805-12.688997-4.519943-24.912389-6.79066-36.668131-6.79066-41.654702 1.824555-63.383586 28.073382-65.186651 78.767971 2.715855 47.999201 24.444738 73.335239 65.186651 76.052117 11.755742 0 24.445762-3.162016 38.026058-9.506515 7.235798-3.607154 13.113669-5.432733 17.655102-5.432733 12.668531 0.912789 20.370956 9.061376 23.086811 24.444738-0.912789 24.445762-27.161616 37.113269-78.767971 38.026058-74.248028-4.519943-114.077152-46.174646-119.509884-124.942617C231.91393 158.543899 271.743054 115.976408 345.991082 110.544699L345.991082 110.544699z"
                            fill="#01B695"
                            p-id="24207"
                            ></path>
                        </svg>
                        {% elif stat.icon == 'breath' %}
                            <svg
                            t="1765679809370"
                            class="icon w-6 h-6"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="30291"
                            width="48"
                            height="48"
                        >
                            <path
                            d="M540.8 185.6c-3.2-12.8-16-25.6-28.8-25.6-16 0-32 12.8-32 32V435.2c-6.4 35.2-44.8 60.8-102.4 60.8-16 0-32 12.8-32 32s12.8 32 32 32h32c41.6-6.4 80-22.4 102.4-51.2l3.2-3.2 3.2 3.2c28.8 32 76.8 48 131.2 48 16 0 32-12.8 32-32s-12.8-32-32-32c-60.8 0-102.4-28.8-102.4-67.2V192l-6.4-6.4zM611.2 288c12.8-9.6 25.6-12.8 41.6-9.6h9.6l9.6 3.2c76.8 22.4 160 105.6 192 284.8 25.6 134.4 22.4 220.8-9.6 268.8-12.8 19.2-28.8 28.8-48 32h-9.6c-16 0-35.2-6.4-44.8-12.8-35.2 3.2-70.4 3.2-105.6-3.2-51.2-12.8-86.4-38.4-92.8-80-6.4-41.6-9.6-89.6-6.4-166.4 0-19.2 16-32 32-32s28.8 16 28.8 35.2v38.4c0 51.2 0 86.4 6.4 115.2 6.4 28.8 73.6 41.6 137.6 32 6.4 0 12.8 0 19.2 3.2 9.6 6.4 22.4 9.6 28.8 9.6 3.2 0 3.2-3.2 6.4-6.4 19.2-25.6 22.4-92.8 0-217.6-16-89.6-48-153.6-89.6-195.2-25.6-25.6-48-38.4-64-41.6h-3.2l-3.2 3.2c-6.4 6.4-12.8 28.8-19.2 67.2-3.2 16-19.2 28.8-35.2 25.6-16-3.2-28.8-19.2-25.6-38.4 6.4-67.2 19.2-99.2 44.8-115.2z m-249.6-9.6c19.2-3.2 38.4 0 51.2 9.6 22.4 16 38.4 48 48 108.8 3.2 16-9.6 35.2-25.6 38.4-16 3.2-32-9.6-35.2-25.6-6.4-38.4-12.8-60.8-19.2-67.2l-3.2-3.2h-3.2c-16 3.2-38.4 16-64 41.6-41.6 41.6-73.6 105.6-89.6 195.2-22.4 124.8-19.2 192 0 217.6l6.4 6.4c6.4 0 19.2-3.2 28.8-9.6 6.4-3.2 12.8-6.4 19.2-3.2 64 9.6 134.4-3.2 137.6-32 6.4-35.2 9.6-80 6.4-153.6 0-19.2 12.8-32 28.8-32s32 12.8 32 32c3.2 80 0 128-6.4 166.4-9.6 44.8-41.6 70.4-92.8 80-35.2 6.4-70.4 6.4-102.4 3.2-16 6.4-32 12.8-51.2 12.8h-9.6c-19.2-3.2-35.2-12.8-48-32-32-44.8-35.2-134.4-9.6-268.8 35.2-185.6 124.8-265.6 201.6-284.8z"
                            fill="#0b988f"
                            p-id="30292"
                            ></path>
                        </svg> 
                        {% elif stat.icon == 'sputum' %}
                        <svg
                            t="1765679596369"
                            class="icon w-5 h-5"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="25405"
                            width="48"
                            height="48"
                        >
                            <path
                            d="M668.58734933 702.14178133a34.95253333 34.95253333 0 0 1-3.49525333-69.90506666l86.91529955-9.08765867-17.47626666-27.72900978a34.95253333 34.95253333 0 0 1 23.30168889-53.12785067l155.65528177-26.56392533a34.95253333 34.95253333 0 0 1 11.88386134 69.90506667l-104.15854934 17.70928356 19.34040178 30.99124622a34.95253333 34.95253333 0 0 1-25.63185778 52.66181688l-142.83935288 14.9130809zM927.46911289 930.03229867a33.78744889 33.78744889 0 0 1-21.43755378-7.45654045l-101.59536356-80.15780977-21.20453688 49.86561422a35.18555022 35.18555022 0 0 1-55.45801956 12.34989511l-118.13956266-104.62458311a34.71951645 34.71951645 0 1 1 46.60337777-52.19578312l82.02194489 72.46825245 20.03945244-46.60337778a35.88460089 35.88460089 0 0 1 23.3016889-20.27246933 34.48649955 34.48649955 0 0 1 30.29219555 6.52447289l137.71298133 108.58587022a34.48649955 34.48649955 0 0 1 5.59240534 48.93354667 34.25348267 34.25348267 0 0 1-27.72900978 12.582912z"
                            fill="#cbdaf9"
                            p-id="25406"
                            data-spm-anchor-id="a313x.search_index.0.i30.323b3a81mlEN19"
                            class=""
                            ></path>
                            <path
                            d="M407.1424 802.33904355a34.95253333 34.95253333 0 0 1-19.34040178-64.07964444 56.85612089 56.85612089 0 0 0 0-98.566144A34.95253333 34.95253333 0 1 1 426.48280178 581.90506667a126.52817067 126.52817067 0 0 1 0 214.84157155 34.25348267 34.25348267 0 0 1-19.34040178 5.59240533z"
                            fill="#2563eb"
                            p-id="25407"
                            data-spm-anchor-id="a313x.search_index.0.i28.323b3a81mlEN19"
                            class="selected"
                            ></path>
                            <path
                            d="M465.39662222 676.50992355a34.95253333 34.95253333 0 1 1 0-69.90506666c40.54493867 0 48.70052978-7.92257422 49.86561423-9.55369244s6.52447289-12.582912-3.96128712-53.36086756a34.25348267 34.25348267 0 0 1 5.35938845-29.12711111 34.71951645 34.71951645 0 0 1 25.63185777-14.680064 288.24189155 288.24189155 0 0 0 107.88681956-26.56392533 107.42078578 107.42078578 0 0 0-10.01972622-9.55369245c-85.05116445-69.90506667-146.10158933-151.22796089-188.04462934-332.51510045a34.95253333 34.95253333 0 1 1 67.57489778-15.37911466c37.51571911 163.11182222 88.77943467 231.15275378 164.50992356 294.30033066 40.07890489 33.554432 41.01097245 63.61361067 34.95253333 83.18702934-14.21403022 44.73924267-82.25496178 63.84662755-133.28566044 72.00221866a98.566144 98.566144 0 0 1-16.07816533 74.79842134c-24.93280711 32.15633067-69.206016 36.35063467-104.39156623 36.35063466z m186.41351111-198.76340622zM544.38934755 935.624704a36.58365155 36.58365155 0 0 1-15.61213155-3.72827022 35.18555022 35.18555022 0 0 1-15.61213155-46.60337778 79.45875911 79.45875911 0 0 0 8.62162488-65.24472889 101.59536355 101.59536355 0 0 0-63.84662755-46.60337778 34.95253333 34.95253333 0 1 1 21.90358755-66.40981333A163.11182222 163.11182222 0 0 1 586.33238755 791.62026667a145.40253867 145.40253867 0 0 1-10.71877688 123.731968 34.95253333 34.95253333 0 0 1-31.22426312 20.27246933zM341.19862045 929.333248a279.62026667 279.62026667 0 0 1 0-559.24053333 34.95253333 34.95253333 0 0 1 0 69.90506666 209.7152 209.7152 0 0 0 0 419.4304 34.95253333 34.95253333 0 0 1 0 69.90506667z"
                            fill="#2563eb"
                            p-id="25408"
                            data-spm-anchor-id="a313x.search_index.0.i27.323b3a81mlEN19"
                            class=""
                            ></path>
                        </svg>
                        {% elif stat.icon == 'pain' %}
                        <svg
                            class="w-5 h-5 text-red-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z"
                            />
                        </svg>
                        {% elif stat.icon == 'weight' %}
                        <svg
                            class="w-5 h-5 text-emerald-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"
                            />
                        </svg>
                        {% elif stat.icon == 'spo2' %}
                         <svg
                            class="w-5 h-5 text-cyan-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
                            />
                        </svg>
                        {% elif stat.icon == 'bp' %}
                         <svg
                            class="w-5 h-5 text-purple-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                            />
                        </svg>
                        {% elif stat.icon == 'heart' %}
                        <svg t="1765984006363" class="icon w-5 h-5" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5839" width="48" height="48"><path d="M507.5328 210.1888l4.0064 3.8656 3.968-3.8016c126.6816-119.936 272.256-123.072 373.2352-24.5248l3.3152 3.2896c102.3104 103.1168 111.7952 270.3744 2.9952 378.0608L537.6256 898.9184a38.4 38.4 0 0 1-52.2496 0L127.9488 567.0784l-1.1392-1.1008c-106.4448-107.328-96.6144-274.6496 5.0944-377.5744 100.7488-101.9776 247.6416-99.84 375.6288 21.7856z m-320.9984 32.192c-72.3968 73.2672-80.2432 190.2336-8.3712 266.24l2.7648 2.8416 330.5728 306.9184 330.4064-306.7264c75.0592-74.3296 69.5936-190.7968-1.2544-265.344l-3.1232-3.2c-77.44-78.08-190.528-69.9264-297.1136 52.032a38.4 38.4 0 0 1-57.856-0.0384c-106.624-122.3424-219.008-130.6752-296.0256-52.736z m299.9296 108.16l77.9264 181.504 48.64-60.1344a38.4 38.4 0 0 1 27.1872-14.1696l2.6624-0.0896h98.944a38.4 38.4 0 0 1 0 76.8l-80.6016-0.0128-77.1072 95.3984c-17.664 21.8496-51.7248 17.8432-64.128-6.7584l-1.024-2.2272-71.168-165.7088-30.592 58.6624a38.4 38.4 0 0 1-31.5392 20.5568l-2.5088 0.0896h-101.0176a38.4 38.4 0 1 1 0-76.8l77.7216-0.0128 57.28-109.7088c14.976-28.6976 56.5504-27.136 69.3248 2.6112z" fill="#FF5308" p-id="5840"></path></svg>
                        {% endif %}
                    </div>
                    
                    <!-- Content -->
                    <div>
                        <h3 class="font-bold text-slate-800 text-base mb-1 " style="max-width: 220px;">{{ stat.title }}</h3>
                        <div class="flex items-center gap-4 text-sm text-slate-500 font-medium">
                            <span>记录：{{ stat.count }}次</span>
                            <div class="flex items-center gap-1">
                                {% if stat.abnormal > 0 %}
                                <svg class="w-4 h-4 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                                {% endif %}
                                <span>异常：{{ stat.abnormal }}次</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Button -->
                <button onclick="window.location.href='{% url 'web_patient:health_record_detail' %}?type={{ stat.type }}&title={{ stat.title }}&patient_id={{ patient_id|default:'' }}'" class="bg-blue-600 text-white text-sm font-bold px-3 py-1.5 rounded shadow-sm hover:bg-blue-700 active:scale-95 transition">
                    查看详情
                </button>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Empty State -->
        <div class="flex flex-col items-center justify-center py-10">
                <div class="flex items-center justify-center mb-3 ">
               <svg  class="w-[140px] h-[140px]" height="1291" node-id="1" sillyvg="true" template-height="1291" template-width="1430" version="1.1" viewBox="0 0 1430 1291" width="1430" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs node-id="47"><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_10" node-id="5" spreadMethod="pad" x1="714.93" x2="714.93" y1="1290.92" y2="995.69"><stop offset="0" stop-color="#f7fbff" stop-opacity="0.5"/><stop offset="1" stop-color="#ecf5ff"/></linearGradient><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_14" node-id="8" spreadMethod="pad" x1="754.65" x2="950.36" y1="1394.38" y2="1394.38"><stop offset="0" stop-color="#dcedff"/><stop offset="1" stop-color="#4095e6"/></linearGradient><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_15" node-id="11" spreadMethod="pad" x1="1227.25" x2="1007.27" y1="66.57" y2="66.57"><stop offset="0" stop-color="#f7fbff"/><stop offset="1" stop-color="#ecf5ff"/></linearGradient><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_14-2" node-id="14" spreadMethod="pad" x1="754.19" x2="754.19" y1="998.75" y2="475.29"><stop offset="0" stop-color="#dcedff"/><stop offset="1" stop-color="#4095e6"/></linearGradient><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_51" node-id="15" spreadMethod="pad" x1="755.45" x2="755.45" y1="503.63" y2="451.53"><stop offset="0" stop-color="#64aaec"/><stop offset="1" stop-color="#4095e6"/></linearGradient><linearGradient gradientUnits="objectBoundingBox" id="_未命名的渐变_14-3" node-id="18" spreadMethod="pad" x1="752.01" x2="752.01" y1="802.5" y2="608.5"><stop offset="0" stop-color="#dcedff"/><stop offset="1" stop-color="#4095e6"/></linearGradient></defs><g node-id="146"><path d="M 1429.86 1143.31 C 1429.86 1182.46 1354.54 1220.01 1220.46 1247.69 C 1086.39 1275.38 904.54 1290.93 714.93 1290.93 C 525.32 1290.93 343.47 1275.38 209.40 1247.69 C 75.32 1220.01 0.00 1182.46 0.00 1143.31 C 0.00 1104[... 8825 chars omitted ...]
            </div>
            <p class="text-slate-500 font-medium text-sm">暂无健康档案记录</p>
            <p class="text-slate-400 text-sm mt-0.5">请先进行相关指标的记录</p>
        </div>
        {% endif %}

    </div>
</div>
<script>
    function goHomeReplace() {
        var url = "{% url 'web_patient:patient_home' %}?patient_id={{ patient_id }}";
        window.location.replace(url);
    }
</script>
{% endblock %}
