{% extends "layouts/base_portal.html" %}

{% block title %}健康档案{% endblock %}

{% block body %}
<div class="min-h-screen bg-[#F5F5F5] font-sans pb-10">
    
    <!-- Top Header -->
    <div class="bg-white sticky top-0 z-30 shadow-sm">
        <div class="pt-safe-top">
            <div class="flex items-center h-12 px-4 relative">
                <a href="javascript:history.back()" class="absolute left-4 p-2 -ml-2 text-slate-600 active:opacity-60">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </a>
                <h1 class="w-full text-center text-lg font-bold text-slate-800">健康档案</h1>
            </div>
        </div>
    </div>

    <div class="px-4 pt-6">
        
        {% if health_stats %}
        <div class="bg-white rounded-xl shadow-sm overflow-hidden divide-y divide-slate-100">
            {% for stat in health_stats %}
            <div class="p-4 flex items-center justify-between active:bg-slate-50 transition">
                <div class="flex items-start gap-3">
                    <!-- Icon -->
                    <div class="w-6 h-6 flex items-center justify-center text-blue-600 mt-0.5">
                        {% if stat.icon == 'medication' %}
                        <svg t="1765803006127" class="icon w-5 h-5" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2262" width="32" height="32"><path d="M487.867733 148.292267L148.309333 487.867733c-106.717867 106.7008-106.717867 281.105067 0 387.822934 106.717867 106.7008 281.122133 106.7008 387.822934 0L875.690667 536.132267c106.717867-106.717867 106.717867-281.122133 0-387.84-106.7008-106.7008-281.122133-106.7008-387.822934 0z m339.5584 48.264533c80.042667 80.059733 80.042667 211.2512 0 291.310933L487.867733 827.426133c-80.042667 80.042667-211.234133 80.042667-291.293866 0-80.042667-80.042667-80.042667-211.234133 0-291.2768l339.5584-339.592533c80.042667-80.042667 211.2512-80.042667 291.293866 0z" fill="#2563eb" p-id="2263"></path><path d="M450.798933 402.5344l181.026134 181.009067-24.132267 24.149333a34.133333 34.133333 0 0 1-48.2816 0L426.666667 474.9312A34.133333 34.133333 0 0 1 426.666667 426.666667l24.132266-24.132267z" fill="#2563eb" p-id="2264"></path></svg>
                        {% elif stat.icon == 'temperature' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                        {% elif stat.icon == 'breath' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" /></svg>
                        {% elif stat.icon == 'sputum' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" /></svg>
                        {% elif stat.icon == 'pain' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        {% elif stat.icon == 'weight' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>
                        {% elif stat.icon == 'spo2' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>
                        {% elif stat.icon == 'steps' %}
                        <svg t="1765803153188" class="icon w-5 h-5" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5168" width="32" height="32"><path d="M742.4 992h-12.8c-25.6 0-51.2-12.8-64-32l-281.6-307.2-6.4-6.4c-6.4-19.2-12.8-25.6-12.8-38.4 0-12.8 0-25.6 6.4-38.4l12.8-51.2-38.4 12.8c0 6.4 6.4 19.2 6.4 32s-6.4 19.2-6.4 32l-25.6 25.6c-12.8 12.8-19.2 12.8-32 19.2-19.2 6.4-44.8 6.4-64-6.4-12.8 0-19.2-12.8-32-19.2-6.4-6.4-12.8-19.2-12.8-32l-25.6-83.2c-6.4-19.2-6.4-38.4 6.4-57.6 6.4-19.2 19.2-32 38.4-44.8l12.8-6.4c19.2-6.4 134.4-57.6 236.8-102.4 32-12.8 51.2-25.6 51.2-25.6-6.4-6.4-12.8-19.2-19.2-25.6-19.2-25.6-25.6-44.8-25.6-70.4 0-38.4 19.2-70.4 44.8-96 25.6-25.6 57.6-38.4 96-38.4 25.6 0 51.2 12.8 70.4 25.6 19.2 12.8 38.4 38.4 44.8 57.6 6.4 25.6 6.4 51.2 6.4 76.8-6.4 25.6-19.2 44.8-38.4 64-19.2 19.2-32 25.6-51.2 32 12.8 6.4 19.2 19.2 25.6 38.4 6.4 19.2 12.8 44.8 6.4 64l-38.4 243.2 198.4 204.8c6.4 12.8 12.8 19.2 19.2 32 6.4 12.8 6.4 25.6 6.4 38.4 0 12.8-6.4 25.6-12.8 38.4-6.4 12.8-12.8 19.2-25.6 25.6-19.2 12.8-44.8 19.2-64 19.2zM435.2 428.8c6.4 0 12.8 0 19.2 6.4 6.4 12.8 12.8 25.6 12.8 32l-38.4 121.6V608l281.6 307.2c6.4 6.4 12.8 12.8 25.6 12.8s19.2 0 25.6-6.4c6.4 0 6.4-6.4 6.4-6.4 0-6.4 0-6.4 6.4-12.8v-12.8c0-6.4 0-6.4-6.4-12.8l-204.8-217.6c-6.4-6.4-12.8-19.2-6.4-25.6l44.8-262.4v-25.6c-12.8 0-12.8-6.4-25.6-12.8-6.4 0-6.4-6.4-6.4-6.4-6.4 0-12.8-6.4-19.2-6.4h-25.6s-19.2 6.4-51.2 19.2C403.2 377.6 256 441.6 243.2 448l-19.2 6.4c0 6.4-6.4 6.4-6.4 12.8v12.8l19.2 89.6 6.4 6.4h32l6.4-6.4v-6.4-6.4l-6.4-38.4c-6.4-12.8 6.4-25.6 19.2-32l128-51.2c0-6.4 6.4-6.4 12.8-6.4z m153.6-332.8c-19.2 0-32 6.4-44.8 19.2-12.8 12.8-25.6 32-25.6 51.2 0 12.8 6.4 25.6 12.8 38.4 6.4 12.8 19.2 19.2 32 25.6 12.8 6.4 25.6 6.4 38.4 6.4 12.8 0 25.6-6.4 32-19.2l19.2-38.4v-38.4c-6.4-12.8-12.8-19.2-25.6-32-12.8-6.4-19.2-12.8-38.4-12.8z" fill="#2563eb" p-id="5169"></path><path d="M307.2 921.6h-12.8l-140.8-44.8c-25.6-6.4-38.4-25.6-51.2-44.8-6.4-19.2-6.4-44.8 0-64 0-6.4 6.4-19.2 12.8-25.6s12.8-19.2 25.6-25.6c6.4-6.4 19.2-12.8 25.6-12.8h32l51.2 19.2 19.2-32c6.4-12.8 19.2-19.2 32-25.6 12.8-6.4 25.6 0 38.4 6.4 6.4 0 12.8 6.4 12.8 12.8l57.6 64c6.4 12.8 12.8 19.2 12.8 32s0 25.6-12.8 32l-32 51.2c6.4 19.2-6.4 32-25.6 44.8-12.8 6.4-25.6 12.8-44.8 12.8z m-121.6-160c-6.4 0-12.8 0-12.8 6.4l-6.4 6.4s0 6.4-6.4 6.4v19.2c0 6.4 6.4 6.4 12.8 12.8l134.4 44.8s6.4 0 12.8-6.4c6.4 0 6.4-6.4 12.8-12.8l32-51.2-44.8-51.2-32 57.6-102.4-32zM800 595.2c-12.8 0-25.6 0-38.4-6.4l-64-32S672 544 672 512l12.8-89.6c6.4-19.2 12.8-25.6 25.6-32 6.4-6.4 19.2-6.4 32 0l12.8 6.4 89.6 38.4c6.4 0 12.8 6.4 19.2 12.8 6.4 6.4 12.8 19.2 19.2 32 6.4 12.8 6.4 25.6 6.4 32 0 12.8 0 25.6-6.4 32-6.4 12.8-12.8 19.2-19.2 25.6-6.4 6.4-19.2 12.8-32 19.2-12.8 6.4-19.2 6.4-32 6.4z m-64-89.6l57.6 25.6h19.2c6.4 0 6.4 0 6.4-6.4s6.4-6.4 6.4-6.4V512v-6.4s0-6.4-6.4-6.4l-6.4-6.4-70.4-32-6.4 44.8z m-19.2-6.4c6.4 0 0 0 0 0z m6.4-51.2z" fill="#2563eb" p-id="5170"></path></svg>
                        {% elif stat.icon == 'bp' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                        {% elif stat.icon == 'lab' %}
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                        {% endif %}
                    </div>
                    
                    <!-- Content -->
                    <div>
                        <h3 class="font-bold text-slate-800 text-base mb-1 " style="max-width: 220px;">{{ stat.title }}</h3>
                        <div class="flex items-center gap-4 text-sm text-slate-500 font-medium">
                            <span>记录：{{ stat.count }}次</span>
                            <div class="flex items-center gap-1">
                                {% if stat.abnormal > 0 %}
                                <svg class="w-4 h-4 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                                {% endif %}
                                <span>异常：{{ stat.abnormal }}次</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Button -->
                <button onclick="window.location.href='{% url 'web_patient:health_record_detail' %}?type={{ stat.type }}&title={{ stat.title }}&patient_id={{ pa | default:'' }}'" class="bg-blue-600 text-white text-sm font-bold px-3 py-1.5 rounded shadow-sm hover:bg-blue-700 active:scale-95 transition">
                    查看详情
                </button>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Empty State -->
      <div class="flex flex-col items-center justify-center py-10">
        <div class="flex items-center justify-center mb-3">
            <svg t="1765808670850" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8014" width="64" height="64"><path d="M35.698301 77.721345h59.476898c4.135408 0 7.419408 3.284 7.419408 7.419408s-3.284 7.419408-7.419408 7.419409H35.698301c-4.135408 0-7.419408-3.284-7.419408-7.419409s3.284-7.419408 7.419408-7.419408z m0 0" fill="#F4C15B" p-id="8015"></path><path d="M65.497565 47.922081c4.135408 0 7.419408 3.284 7.419409 7.419408v59.476898c0 4.135408-3.284 7.419408-7.419409 7.419408-4.135408 0-7.419408-3.284-7.419408-7.419408V55.341489c0-4.135408 3.284-7.419408 7.419408-7.419408z m0 0" fill="#F4C15B" p-id="8016"></path><path d="M362.030645 116.277943l28.704597 7.662668c4.013778 1.094667 6.324742 5.108445 5.230075 9.122223-1.094667 4.013778-5.108445 6.324742-9.122224 5.230075l-28.704597-7.662668c-4.013778-1.094667-6.324742-5.108445-5.230075-9.122223 1.216296-3.892149 5.108445-6.324742 9.122224-5.230075z m0 0" fill="#4680E8" p-id="8017"></path><path d="M414.939542 74.558974l7.662667 28.704596c1.094667 4.013778-1.216296 8.027557-5.230075 9.122224-4.013778 1.094667-8.027557-1.216296-9.122223-5.230075L400.587243 78.329493c-1.094667-4.013778 1.216296-8.027557 5.230075-9.122224 4.013778-0.973037 8.149186 1.337926 9.122224 5.351705z m0 0" fill="#8FB3FF" p-id="8018"></path><path d="M477.57881 99.493051L456.536881 120.53498c-2.919112 2.919112-7.541038 2.919112-10.46015 0-2.919112-2.919112-2.919112-7.541038 0-10.460149l21.041929-21.041929c2.919112-2.919112 7.541038-2.919112 10.46015 0 2.919112 2.797482 2.919112 7.541038 0 10.460149z m0 0" fill="#ABC3EF" p-id="8019"></path><path d="M927.000356 113.358831c-24.569189 0-44.516451 19.947262-44.516451 44.638081 0 24.569189 19.947262 44.516451 44.516451 44.516451 24.569189 0 44.638081-19.947262 44.638081-44.516451-0.12163-24.690818-20.068892-44.638081-44.638081-44.638081z m0 74.315715c-16.420002 0-29.799264-13.379261-29.799263-29.799264s13.379261-29.799264 29.799263-29.799263 29.799264 13.379261 29.799264 29.799263c-0.12163 16.541632-13.500891 29.799264-29.799264 29.799264z m0 0" fill="#F4C15B" p-id="8020"></path><path d="M905.715168 374.984202l-446.137546-59.476897v235.718256l446.137546 46.827414V374.984202z m0 0" fill="#4680E8" p-id="8021"></path><path d="M102.594607 392.742131l356.861385-77.113196v267.706853L102.594607 660.448984V392.742131z m0 0" fill="#8FB3FF" p-id="8022"></path><path d="M519.05452 482.018292l386.660648-106.91246V880.598646l-386.660648 106.91246V482.018292z m0 0" fill="#4680E8" p-id="8023"></path><path d="M102.594607 392.742131l416.338283 89.276161v502.816962L102.594607 883.517757V392.742131z m0 0" fill="#8FB3FF" p-id="8024"></path><path d="M519.05452 481.166884L102.594607 392.742131l-89.276161 178.430692 431.298729 101.317497 74.437345-191.323436z m0 0" fill="#ABC3EF" p-id="8025"></path><path d="M756.597221 28.461337L711.95914 46.584155v59.476897l44.638081-18.122817V28.461337z m0 0" fill="#F4C15B" p-id="8026"></path><path d="M659.780021 87.938235l44.638081 18.122817V46.584155l-44.638081-18.122818v59.476898z m96.8172-65.43675L708.796769 3.648889l-48.895118 16.906521 48.773489 20.67704 47.922081-18.730965z m0 0" fill="#E5CF6E" p-id="8027"></path><path d="M519.05452 482.018292l386.660648-106.91246 104.114978 178.430693-371.821831 121.751276-118.953795-193.269509z m0 0" fill="#8FB3FF" p-id="8028"></path><path d="M728.257513 388.241834S744.799145 283.883597 831.156194 231.947737c0 0 7.541038 8.514075 22.623115 27.853189 0 0-39.408006-6.203112-125.521796 128.440908z m0 0" fill="#ABC3EF" p-id="8029"></path><path d="M519.05452 383.984796s1.702815-57.165934 43.543413-186.09336c0 0 7.541038 8.514075 22.623115 27.853189-0.12163 0-15.933484 13.74415-66.166528 158.240171z m0 0" fill="#8FB3FF" p-id="8030"></path><path d="M373.585461 373.646276S326.514788 235.231738 211.209882 172.835729c0 0-19.217484 27.001782-40.381042 35.515857-0.12163 0 132.697945 46.219266 202.756621 165.29469z m0 0" fill="#E5CF6E" p-id="8031"></path></svg>
        </div>
        <p class="text-slate-500 font-medium text-sm">今日暂无计划</p>
        <p class="text-slate-400 text-sm mt-0.5">请联系医生为您制定康复计划</p>
      </div>
        {% endif %}

    </div>
</div>
{% endblock %}
