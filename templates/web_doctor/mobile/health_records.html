{% extends "layouts/base_portal.html" %}

{% block title %}健康档案{% endblock %}

{% block body %}
<div class="min-h-screen bg-[#F5F5F5] font-sans pb-10">
    
    <div class="bg-white sticky top-0 z-30 shadow-sm">
        <div class="pt-safe-top">
            <div class="flex items-center h-12 px-4 relative">
                <div  onclick="window.history.back()" class="cursor-pointer absolute left-4 p-2 -ml-2 text-slate-600 active:opacity-60">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </div>
                <h1 class="w-full text-center text-lg font-bold text-slate-800">健康档案</h1> 
            </div>
            <div id="service-package-section" class="px-4 pb-3{% if not service_packages %} hidden{% endif %}">
                <div class="flex items-center gap-3">
                    <div class="flex-1">
                        <label for="servicePackageSelect" class="block text-xs font-medium text-slate-500 mb-1">服务包</label>
                        <div class="relative">
                            <select id="servicePackageSelect" class="w-full appearance-none bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 pr-9 text-sm font-semibold text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                {% for pkg in service_packages %}
                                <option value="{{ pkg.id }}" {% if pkg.id == selected_package_id %}selected{% endif %}>
                                    {{ pkg.name }}（{{ pkg.start_date|date:"Y-m-d" }} ~ {{ pkg.end_date|date:"Y-m-d" }}）
                                </option>
                                {% endfor %}
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-slate-400">
                                <svg class="w-4 h-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 text-xs text-slate-500">
                    当前统计范围：{{ selected_date_range.start_date|date:"Y-m-d" }} ~ {{ selected_date_range.end_date|date:"Y-m-d" }}
                </div>
            </div>
        </div>
    </div>

    <div class="px-4 pt-6">
        <div class="text-black font-semibold text-lg mb-2">一般监测指标</div>
        <div class="bg-white rounded-xl shadow-sm overflow-hidden divide-y divide-slate-100">
            {% for stat in health_stats %}
            <div class="p-4 flex items-center justify-between active:bg-slate-50 transition">
                <div class="flex items-start gap-3">
                    <div class="w-6 h-6 flex items-center justify-center text-blue-600 mt-0.5">
                        {% if stat.icon == 'medical' %}
                        <svg t="1767624609505" class="icon w-5 h-5" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4446" width="32" height="32"><path d="M919.29 104.71c-108.12-108.12-284.08-108.12-392.21 0L316.26 315.53c-0.12 0.12-0.27 0.2-0.4 0.33-0.12 0.12-0.2 0.27-0.33 0.4L104.71 527.08c-108.14 108.12-108.14 284.08 0 392.21 54.06 54.06 125.08 81.1 196.1 81.1s142.04-27.04 196.1-81.1l210.82-210.82c0.12-0.12 0.27-0.2 0.4-0.33 0.12-0.12 0.2-0.27 0.33-0.4l210.83-210.83c108.14-108.12 108.14-284.08 0-392.2zM436.58 858.96c-74.88 74.88-196.67 74.88-271.54 0-74.85-74.88-74.85-196.67 0-271.54L346.06 406.4 617.6 677.94 436.58 858.96z m422.38-422.38L677.93 617.61 406.4 346.06l181.02-181.02c37.44-37.44 86.6-56.15 135.77-56.15s98.33 18.71 135.77 56.15c74.85 74.88 74.85 196.67 0 271.54z" fill="#206AF0" p-id="4447"></path><path d="M725.33 170.67c-23.56 0-42.67 19.1-42.67 42.67S701.77 256 725.33 256c23.53 0 42.67 19.15 42.67 42.67 0 23.56 19.1 42.67 42.67 42.67s42.67-19.1 42.67-42.67c-0.01-70.59-57.42-128-128.01-128z" fill="#206AF0" p-id="4448"></path></svg>
                        {% elif stat.icon == 'step' %}
                        <svg t="1767624675057" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7285" width="32" height="32"><path d="M742.4 992h-12.8c-25.6 0-51.2-12.8-64-32l-281.6-307.2-6.4-6.4c-6.4-19.2-12.8-25.6-12.8-38.4 0-12.8 0-25.6 6.4-38.4l12.8-51.2-38.4 12.8c0 6.4 6.4 19.2 6.4 32s-6.4 19.2-6.4 32l-25.6 25.6c-12.8 12.8-19.2 12.8-32 19.2-19.2 6.4-44.8 6.4-64-6.4-12.8 0-19.2-12.8-32-19.2-6.4-6.4-12.8-19.2-12.8-32l-25.6-83.2c-6.4-19.2-6.4-38.4 6.4-57.6 6.4-19.2 19.2-32 38.4-44.8l12.8-6.4c19.2-6.4 134.4-57.6 236.8-102.4 32-12.8 51.2-25.6 51.2-25.6-6.4-6.4-12.8-19.2-19.2-25.6-19.2-25.6-25.6-44.8-25.6-70.4 0-38.4 19.2-70.4 44.8-96 25.6-25.6 57.6-38.4 96-38.4 25.6 0 51.2 12.8 70.4 25.6 19.2 12.8 38.4 38.4 44.8 57.6 6.4 25.6 6.4 51.2 6.4 76.8-6.4 25.6-19.2 44.8-38.4 64-19.2 19.2-32 25.6-51.2 32 12.8 6.4 19.2 19.2 25.6 38.4 6.4 19.2 12.8 44.8 6.4 64l-38.4 243.2 198.4 204.8c6.4 12.8 12.8 19.2 19.2 32 6.4 12.8 6.4 25.6 6.4 38.4 0 12.8-6.4 25.6-12.8 38.4-6.4 12.8-12.8 19.2-25.6 25.6-19.2 12.8-44.8 19.2-64 19.2zM435.2 428.8c6.4 0 12.8 0 19.2 6.4 6.4 12.8 12.8 25.6 12.8 32l-38.4 121.6V608l281.6 307.2c6.4 6.4 12.8 12.8 25.6 12.8s19.2 0 25.6-6.4c6.4 0 6.4-6.4 6.4-6.4 0-6.4 0-6.4 6.4-12.8v-12.8c0-6.4 0-6.4-6.4-12.8l-204.8-217.6c-6.4-6.4-12.8-19.2-6.4-25.6l44.8-262.4v-25.6c-12.8 0-12.8-6.4-25.6-12.8-6.4 0-6.4-6.4-6.4-6.4-6.4 0-12.8-6.4-19.2-6.4h-25.6s-19.2 6.4-51.2 19.2C403.2 377.6 256 441.6 243.2 448l-19.2 6.4c0 6.4-6.4 6.4-6.4 12.8v12.8l19.2 89.6 6.4 6.4h32l6.4-6.4v-6.4-6.4l-6.4-38.4c-6.4-12.8 6.4-25.6 19.2-32l128-51.2c0-6.4 6.4-6.4 12.8-6.4z m153.6-332.8c-19.2 0-32 6.4-44.8 19.2-12.8 12.8-25.6 32-25.6 51.2 0 12.8 6.4 25.6 12.8 38.4 6.4 12.8 19.2 19.2 32 25.6 12.8 6.4 25.6 6.4 38.4 6.4 12.8 0 25.6-6.4 32-19.2l19.2-38.4v-38.4c-6.4-12.8-12.8-19.2-25.6-32-12.8-6.4-19.2-12.8-38.4-12.8z" fill="#3662EC" p-id="7286"></path><path d="M307.2 921.6h-12.8l-140.8-44.8c-25.6-6.4-38.4-25.6-51.2-44.8-6.4-19.2-6.4-44.8 0-64 0-6.4 6.4-19.2 12.8-25.6s12.8-19.2 25.6-25.6c6.4-6.4 19.2-12.8 25.6-12.8h32l51.2 19.2 19.2-32c6.4-12.8 19.2-19.2 32-25.6 12.8-6.4 25.6 0 38.4 6.4 6.4 0 12.8 6.4 12.8 12.8l57.6 64c6.4 12.8 12.8 19.2 12.8 32s0 25.6-12.8 32l-32 51.2c6.4 19.2-6.4 32-25.6 44.8-12.8 6.4-25.6 12.8-44.8 12.8z m-121.6-160c-6.4 0-12.8 0-12.8 6.4l-6.4 6.4s0 6.4-6.4 6.4v19.2c0 6.4 6.4 6.4 12.8 12.8l134.4 44.8s6.4 0 12.8-6.4c6.4 0 6.4-6.4 12.8-12.8l32-51.2-44.8-51.2-32 57.6-102.4-32zM800 595.2c-12.8 0-25.6 0-38.4-6.4l-64-32S672 544 672 512l12.8-89.6c6.4-19.2 12.8-25.6 25.6-32 6.4-6.4 19.2-6.4 32 0l12.8 6.4 89.6 38.4c6.4 0 12.8 6.4 19.2 12.8 6.4 6.4 12.8 19.2 19.2 32 6.4 12.8 6.4 25.6 6.4 32 0 12.8 0 25.6-6.4 32-6.4 12.8-12.8 19.2-19.2 25.6-6.4 6.4-19.2 12.8-32 19.2-12.8 6.4-19.2 6.4-32 6.4z m-64-89.6l57.6 25.6h19.2c6.4 0 6.4 0 6.4-6.4s6.4-6.4 6.4-6.4V512v-6.4s0-6.4-6.4-6.4l-6.4-6.4-70.4-32-6.4 44.8z m-19.2-6.4c6.4 0 0 0 0 0z m6.4-51.2z" fill="#3662EC" p-id="7287"></path></svg>
                        {% elif stat.icon == 'temperature' %}
                        <svg
                            t="1765679517010"
                            class="icon w-6 h-6"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="24205"
                            width="32"
                            height="32"
                        >
                            <path
                            d="M846.611917 85.510536c-59.643402-39.140439-139.895167-22.38994-178.919972 37.309744L341.052606 622.593817c-7.867178 12.038174-11.592013 31.724539-8.668427 45.816488l20.085454 96.674806L266.953981 895.961882c-12.363585 18.891256-7.082302 44.254923 11.799744 56.646138 18.885116 12.390191 44.193525 7.113001 56.561204-11.778254l84.470857-129.270179 99.121532-20.745487c14.048971-2.960425 30.577413-14.245446 38.444591-26.282596l326.637292-499.773538C923.014005 205.057259 906.247132 124.651998 846.611917 85.510536zM866.518293 253.290797 539.881001 753.064334c-4.828982 7.399527-16.636912 15.46932-25.25929 17.267269L390.907061 796.223297c-2.734274 0.569982-5.499248 0.047072-7.839549-1.474584-2.320858-1.542122-3.921309-3.879354-4.489244-6.603395l-25.749454-123.968429c-1.805112-8.654101 0.867764-22.718421 5.689582-30.116925l326.643432-499.774561c32.712029-50.059116 100.024088-64.095807 150.015665-31.28247C885.185444 135.813199 899.246695 203.243961 866.518293 253.290797zM774.693957 194.285938c-38.542828-25.302269-90.436732-14.480806-115.656113 24.118304l-14.263865 21.825075 37.60241 24.663726c7.603165 4.997827 9.743922 15.259542 4.780887 22.892383-4.999874 7.610328-15.249309 9.748015-22.858614 4.76656l-37.59013-24.681122-51.584865 78.9317 37.601386 24.662703c7.615445 5.01113 9.751085 15.258519 4.770653 22.87908-4.980431 7.621585-15.216563 9.756201-22.817682 4.774747l-37.615713-24.692379-51.577702 78.929654 37.589107 24.681122c3.704368 2.425236 6.230911 6.134721 7.123234 10.45205 0.902556 4.330632 0.069585 8.741082-2.351558 12.42703-4.981455 7.621585-15.232936 9.759271-22.838148 4.761444l-37.59627-24.679076-51.577702 78.929654 37.594223 24.664749c3.697205 2.426259 6.235005 6.149047 7.126304 10.467399 0.900509 4.316306 0.069585 8.741082-2.344395 12.426007-4.983501 7.606235-15.226796 9.741875-22.839171 4.747117L417.768849 587.568093l-10.570753 16.173354c-3.721765 5.705955-5.783727 16.544815-4.384867 23.214724l19.85214 95.576799c0.440022 2.113127 1.674129 3.919263 3.461845 5.105275 1.799996 1.167592 3.935636 1.572822 6.043646 1.1328l95.385441-19.953448c6.650467-1.38658 15.748682-7.614421 19.470447-13.319353l251.835655-385.320832C824.095088 271.575232 813.253158 219.583091 774.693957 194.285938z"
                            fill="#01B695"
                            p-id="24206"
                            ></path>
                            <path
                            d="M176.23277 179.806155c18.10024-1.804089 28.052916-11.755742 29.877471-29.877471-1.824555-17.188474-11.777231-26.694989-29.877471-28.519544-17.20894 1.824555-26.715455 11.33107-28.519544 28.519544C149.517315 168.050414 159.02383 178.002067 176.23277 179.806155L176.23277 179.806155zM176.23277 94.247524c34.397415 3.628644 53.410444 22.195511 57.039087 55.68116-3.628644 34.418904-22.641673 53.431933-57.039087 57.039087-33.506115-3.607154-52.072983-22.620184-55.68116-57.039087C124.159788 116.444059 142.727679 97.876168 176.23277 94.247524L176.23277 94.247524zM345.991082 110.544699c47.977711 2.715855 72.868611 15.405875 74.694189 38.026058-0.912789 14.493086-8.148587 22.195511-21.728884 23.086811-3.628644 0-9.060353-1.357927-16.297175-4.074805-12.688997-4.519943-24.912389-6.79066-36.668131-6.79066-41.654702 1.824555-63.383586 28.073382-65.186651 78.767971 2.715855 47.999201 24.444738 73.335239 65.186651 76.052117 11.755742 0 24.445762-3.162016 38.026058-9.506515 7.235798-3.607154 13.113669-5.432733 17.655102-5.432733 12.668531 0.912789 20.370956 9.061376 23.086811 24.444738-0.912789 24.445762-27.161616 37.113269-78.767971 38.026058-74.248028-4.519943-114.077152-46.174646-119.509884-124.942617C231.91393 158.543899 271.743054 115.976408 345.991082 110.544699L345.991082 110.544699z"
                            fill="#01B695"
                            p-id="24207"
                            ></path>
                        </svg>
                        {% elif stat.icon == 'breath' %}
                            <svg
                            t="1765679809370"
                            class="icon w-6 h-6"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="30291"
                            width="48"
                            height="48"
                        >
                            <path
                            d="M540.8 185.6c-3.2-12.8-16-25.6-28.8-25.6-16 0-32 12.8-32 32V435.2c-6.4 35.2-44.8 60.8-102.4 60.8-16 0-32 12.8-32 32s12.8 32 32 32h32c41.6-6.4 80-22.4 102.4-51.2l3.2-3.2 3.2 3.2c28.8 32 76.8 48 131.2 48 16 0 32-12.8 32-32s-12.8-32-32-32c-60.8 0-102.4-28.8-102.4-67.2V192l-6.4-6.4zM611.2 288c12.8-9.6 25.6-12.8 41.6-9.6h9.6l9.6 3.2c76.8 22.4 160 105.6 192 284.8 25.6 134.4 22.4 220.8-9.6 268.8-12.8 19.2-28.8 28.8-48 32h-9.6c-16 0-35.2-6.4-44.8-12.8-35.2 3.2-70.4 3.2-105.6-3.2-51.2-12.8-86.4-38.4-92.8-80-6.4-41.6-9.6-89.6-6.4-166.4 0-19.2 16-32 32-32s28.8 16 28.8 35.2v38.4c0 51.2 0 86.4 6.4 115.2 6.4 28.8 73.6 41.6 137.6 32 6.4 0 12.8 0 19.2 3.2 9.6 6.4 22.4 9.6 28.8 9.6 3.2 0 3.2-3.2 6.4-6.4 19.2-25.6 22.4-92.8 0-217.6-16-89.6-48-153.6-89.6-195.2-25.6-25.6-48-38.4-64-41.6h-3.2l-3.2 3.2c-6.4 6.4-12.8 28.8-19.2 67.2-3.2 16-19.2 28.8-35.2 25.6-16-3.2-28.8-19.2-25.6-38.4 6.4-67.2 19.2-99.2 44.8-115.2z m-249.6-9.6c19.2-3.2 38.4 0 51.2 9.6 22.4 16 38.4 48 48 108.8 3.2 16-9.6 35.2-25.6 38.4-16 3.2-32-9.6-35.2-25.6-6.4-38.4-12.8-60.8-19.2-67.2l-3.2-3.2h-3.2c-16 3.2-38.4 16-64 41.6-41.6 41.6-73.6 105.6-89.6 195.2-22.4 124.8-19.2 192 0 217.6l6.4 6.4c6.4 0 19.2-3.2 28.8-9.6 6.4-3.2 12.8-6.4 19.2-3.2 64 9.6 134.4-3.2 137.6-32 6.4-35.2 9.6-80 6.4-153.6 0-19.2 12.8-32 28.8-32s32 12.8 32 32c3.2 80 0 128-6.4 166.4-9.6 44.8-41.6 70.4-92.8 80-35.2 6.4-70.4 6.4-102.4 3.2-16 6.4-32 12.8-51.2 12.8h-9.6c-19.2-3.2-35.2-12.8-48-32-32-44.8-35.2-134.4-9.6-268.8 35.2-185.6 124.8-265.6 201.6-284.8z"
                            fill="#0b988f"
                            p-id="30292"
                            ></path>
                        </svg> 
                        {% elif stat.icon == 'sputum' %}
                        <svg
                            t="1765679596369"
                            class="icon w-5 h-5"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="25405"
                            width="48"
                            height="48"
                        >
                            <path
                            d="M668.58734933 702.14178133a34.95253333 34.95253333 0 0 1-3.49525333-69.90506666l86.91529955-9.08765867-17.47626666-27.72900978a34.95253333 34.95253333 0 0 1 23.30168889-53.12785067l155.65528177-26.56392533a34.95253333 34.95253333 0 0 1 11.88386134 69.90506667l-104.15854934 17.70928356 19.34040178 30.99124622a34.95253333 34.95253333 0 0 1-25.63185778 52.66181688l-142.83935288 14.9130809zM927.46911289 930.03229867a33.78744889 33.78744889 0 0 1-21.43755378-7.45654045l-101.59536356-80.15780977-21.20453688 49.86561422a35.18555022 35.18555022 0 0 1-55.45801956 12.34989511l-118.13956266-104.62458311a34.71951645 34.71951645 0 1 1 46.60337777-52.19578312l82.02194489 72.46825245 20.03945244-46.60337778a35.88460089 35.88460089 0 0 1 23.3016889-20.27246933 34.48649955 34.48649955 0 0 1 30.29219555 6.52447289l137.71298133 108.58587022a34.48649955 34.48649955 0 0 1 5.59240534 48.93354667 34.25348267 34.25348267 0 0 1-27.72900978 12.582912z"
                            fill="#cbdaf9"
                            p-id="25406"
                            data-spm-anchor-id="a313x.search_index.0.i30.323b3a81mlEN19"
                            class=""
                            ></path>
                            <path
                            d="M407.1424 802.33904355a34.95253333 34.95253333 0 0 1-19.34040178-64.07964444 56.85612089 56.85612089 0 0 0 0-98.566144A34.95253333 34.95253333 0 1 1 426.48280178 581.90506667a126.52817067 126.52817067 0 0 1 0 214.84157155 34.25348267 34.25348267 0 0 1-19.34040178 5.59240533z"
                            fill="#2563eb"
                            p-id="25407"
                            data-spm-anchor-id="a313x.search_index.0.i28.323b3a81mlEN19"
                            class="selected"
                            ></path>
                            <path
                            d="M465.39662222 676.50992355a34.95253333 34.95253333 0 1 1 0-69.90506666c40.54493867 0 48.70052978-7.92257422 49.86561423-9.55369244s6.52447289-12.582912-3.96128712-53.36086756a34.25348267 34.25348267 0 0 1 5.35938845-29.12711111 34.71951645 34.71951645 0 0 1 25.63185777-14.680064 288.24189155 288.24189155 0 0 0 107.88681956-26.56392533 107.42078578 107.42078578 0 0 0-10.01972622-9.55369245c-85.05116445-69.90506667-146.10158933-151.22796089-188.04462934-332.51510045a34.95253333 34.95253333 0 1 1 67.57489778-15.37911466c37.51571911 163.11182222 88.77943467 231.15275378 164.50992356 294.30033066 40.07890489 33.554432 41.01097245 63.61361067 34.95253333 83.18702934-14.21403022 44.73924267-82.25496178 63.84662755-133.28566044 72.00221866a98.566144 98.566144 0 0 1-16.07816533 74.79842134c-24.93280711 32.15633067-69.206016 36.35063467-104.39156623 36.35063466z m186.41351111-198.76340622zM544.38934755 935.624704a36.58365155 36.58365155 0 0 1-15.61213155-3.72827022 35.18555022 35.18555022 0 0 1-15.61213155-46.60337778 79.45875911 79.45875911 0 0 0 8.62162488-65.24472889 101.59536355 101.59536355 0 0 0-63.84662755-46.60337778 34.95253333 34.95253333 0 1 1 21.90358755-66.40981333A163.11182222 163.11182222 0 0 1 586.33238755 791.62026667a145.40253867 145.40253867 0 0 1-10.71877688 123.731968 34.95253333 34.95253333 0 0 1-31.22426312 20.27246933zM341.19862045 929.333248a279.62026667 279.62026667 0 0 1 0-559.24053333 34.95253333 34.95253333 0 0 1 0 69.90506666 209.7152 209.7152 0 0 0 0 419.4304 34.95253333 34.95253333 0 0 1 0 69.90506667z"
                            fill="#2563eb"
                            p-id="25408"
                            data-spm-anchor-id="a313x.search_index.0.i27.323b3a81mlEN19"
                            class=""
                            ></path>
                        </svg>
                        {% elif stat.icon == 'pain' %}
                        <svg
                            class="w-5 h-5 text-red-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z"
                            />
                        </svg>
                        {% elif stat.icon == 'weight' %}
                        <svg
                            class="w-5 h-5 text-emerald-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"
                            />
                        </svg>
                        {% elif stat.icon == 'spo2' %}
                         <svg
                            class="w-5 h-5 text-cyan-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
                            />
                        </svg>
                        {% elif stat.icon == 'bp' %}
                         <svg
                            class="w-5 h-5 text-purple-500"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                            />
                        </svg>
                        {% elif stat.icon == 'heart' %}
                        <svg t="1765984006363" class="icon w-5 h-5" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5839" width="48" height="48"><path d="M507.5328 210.1888l4.0064 3.8656 3.968-3.8016c126.6816-119.936 272.256-123.072 373.2352-24.5248l3.3152 3.2896c102.3104 103.1168 111.7952 270.3744 2.9952 378.0608L537.6256 898.9184a38.4 38.4 0 0 1-52.2496 0L127.9488 567.0784l-1.1392-1.1008c-106.4448-107.328-96.6144-274.6496 5.0944-377.5744 100.7488-101.9776 247.6416-99.84 375.6288 21.7856z m-320.9984 32.192c-72.3968 73.2672-80.2432 190.2336-8.3712 266.24l2.7648 2.8416 330.5728 306.9184 330.4064-306.7264c75.0592-74.3296 69.5936-190.7968-1.2544-265.344l-3.1232-3.2c-77.44-78.08-190.528-69.9264-297.1136 52.032a38.4 38.4 0 0 1-57.856-0.0384c-106.624-122.3424-219.008-130.6752-296.0256-52.736z m299.9296 108.16l77.9264 181.504 48.64-60.1344a38.4 38.4 0 0 1 27.1872-14.1696l2.6624-0.0896h98.944a38.4 38.4 0 0 1 0 76.8l-80.6016-0.0128-77.1072 95.3984c-17.664 21.8496-51.7248 17.8432-64.128-6.7584l-1.024-2.2272-71.168-165.7088-30.592 58.6624a38.4 38.4 0 0 1-31.5392 20.5568l-2.5088 0.0896h-101.0176a38.4 38.4 0 1 1 0-76.8l77.7216-0.0128 57.28-109.7088c14.976-28.6976 56.5504-27.136 69.3248 2.6112z" fill="#FF5308" p-id="5840"></path></svg>
                        {% endif %}
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-slate-800 text-base mb-1 " style="max-width: 220px;">{{ stat.title }}</h3>
                        <div class="flex items-center gap-4 text-sm text-slate-500 font-medium">
                            <span>记录：{{ stat.count }}次</span>
                            <div class="flex items-center gap-1">
                                <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                                <span class="text-red-500">异常：{{ stat.abnormal }}次</span>
                            </div>
                        </div>
                    </div>
                </div>

                <button onclick="window.location.href='{% url 'web_doctor:mobile_health_record_detail' %}?type={{ stat.type }}&title={{ stat.title }}&patient_id={{ patient_id|default:'' }}{% if stat.type == 'medical' and is_medication_detail_entry %}&source=medication&view=detail{% else %}&source=health_records{% endif %}'" class="bg-blue-600 text-white text-sm font-bold px-3 py-1.5 rounded shadow-sm hover:bg-blue-700 active:scale-95 transition">
                    查看详情
                </button>
            </div>
            {% endfor %}
        </div>
        

        <div id="checkup-section"{% if not is_member %} class="hidden"{% endif %}>
          <div class="text-black font-semibold text-lg mb-2 mt-4">复查档案</div>
          <div class="bg-white rounded-xl shadow-sm overflow-hidden divide-y divide-slate-100">
              {% if checkup_stats %}
                  {% for stat in checkup_stats %}
                  <div class="p-4 flex items-center justify-between active:bg-slate-50 transition">
                      <div class="flex items-start gap-3">
                          <div class="w-6 h-6 flex items-center justify-center text-blue-600 mt-0.5">
                              <svg class="w-5 h-5 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6M7 20h10a2 2 0 002-2V6a2 2 0 00-2-2H9l-2 2H7a2 2 0 00-2 2v10a2 2 0 002 2z" />
                              </svg>
                          </div>
                          <div>
                              <div class="flex items-center gap-2">
                                  <h3 class="font-bold text-slate-800 text-base" style="max-width: 220px;">{{ stat.title }}</h3>
                              </div>
                              <div class="mt-1 flex items-center gap-4 text-sm text-slate-500 font-medium">
                                  <span>记录：{{ stat.count }}次</span>
                                 
                              </div>
                          </div>
                      </div>
                      <button onclick="window.location.href='{% url 'web_doctor:mobile_review_record_detail' %}?title={{ stat.title }}&category_code={{ stat.code }}&patient_id={{ patient_id|default:'' }}'" class="bg-blue-600 text-white text-sm font-bold px-3 py-1.5 rounded shadow-sm hover:bg-blue-700 active:scale-95 transition">
                          查看详情
                      </button>
                  </div>
                  {% endfor %}
              {% else %}
                  <div class="p-4 text-sm text-slate-500">暂无复查档案数据</div>
              {% endif %}
          </div>
        </div>

        <div id="survey-section"{% if not is_member %} class="hidden"{% endif %}>
         <div class="text-black font-semibold text-lg mb-2 mt-4">随访问卷</div>
         <div class=" bg-white rounded-xl shadow-sm overflow-hidden divide-y divide-slate-100">
            {% if health_survey_stats %}
            {% for stat in health_survey_stats %}
            <div class="p-4 flex items-center justify-between active:bg-slate-50 transition">
                <div class="flex items-start gap-3">
                    <div class="w-6 h-6 flex items-center justify-center text-blue-600 mt-0.5">
                        {% if stat.icon == 'physical' %}
                        <svg t="1766814471225" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4507" width="32" height="32"><path d="M596.552 319.504zM726.232 296.808zM681.664 275.024c57.2 0 103.584-46.376 103.584-103.584 0-57.2-46.376-103.576-103.584-103.576-57.208 0-103.584 46.376-103.584 103.576-0.008 57.208 46.376 103.584 103.584 103.584zM681.664 275.024z" fill="#3b82f6" p-id="4508"></path><path d="M852.048 245.2c-59.48 83.304-139.12 92.952-224.824 42.08-5.832-3.464-31.72-17.72-37.448-21.128-137.864-81.84-275.576-49.744-367.92 79.576-39.248 55.008 51.512 107.144 90.32 52.776 47.712-66.816 108.392-86.152 174.744-64.984-33.976 58.976-63.68 117.592-105.6 200.872-41.928 83.28-134.496 149.792-223.432 97.768-64.184-37.504-122.056 54.696-58.072 92.088 121.432 70.976 263.808 27.392 336.496-64.864 2.52 1.344 5.184 2.568 8.104 3.584 59.384 20.688 137.216 75.76 160.936 95.28 23.712 19.52 64.456 118.96 88.64 168.92 29.344 60.624 124.12 16.472 94.664-44.416-27.416-56.688-73.448-169.824-109.352-198.448-28.792-22.96-84.704-65.68-132.136-89.92 32.088-62.144 65.496-123.616 100.664-184.024 112.088 34.344 218.632-6.112 294.512-112.408 39.28-54.992-51.464-107.128-90.296-52.752zM852.048 245.2z" fill="#3b82f6" p-id="4509"></path></svg>
                        {% elif stat.icon == 'breath' %}
                         <svg t="1766929366965" class="icon w-6 h-6" viewBox="0 0 1121 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4389" width="32" height="32"><path d="M541.988571 0a24.380952 24.380952 0 0 0-24.380952 24.380952v414.329905a36.571429 36.571429 0 0 0-29.45219 65.048381l36.035047 27.014095-58.514286 43.885715-0.341333 0.243809c10.337524-155.745524 18.285714-319.292952-13.06819-337.773714-50.029714-29.500952-83.382857-27.696762-116.687238 0-99.961905 73.776762-283.306667 309.784381-300.032 427.78819-3.218286 22.723048-8.874667 48.176762-14.774858 74.605715-24.722286 110.689524-53.150476 237.958095 81.432381 249.904762 166.716952 14.774857 350.061714-29.500952 350.061715-177.005715 0-44.080762 4.437333-110.494476 9.362285-182.759619 12.678095 12.775619 33.158095 14.628571 47.932953 3.510857L585.142857 576.463238l74.947048 56.222476c4.87619 71.094857 9.167238 136.289524 9.167238 179.736381 0 147.504762 183.344762 191.780571 350.012952 177.005715 134.582857-11.897905 106.203429-139.215238 81.481143-249.904762a1002.73981 1002.73981 0 0 1-14.774857-74.605715c-16.676571-118.00381-200.021333-354.011429-300.032-427.78819-33.353143-27.696762-66.657524-29.500952-116.687238 0-22.137905 13.06819-24.673524 98.596571-20.626286 202.654476a36.522667 36.522667 0 0 0-10.386286 5.461333l-34.328381 25.746286V24.380952a24.380952 24.380952 0 0 0-24.380952-24.380952h-37.546667z m111.713524 536.478476l-0.682666-10.922666-6.924191 5.217523 7.606857 5.705143z" fill="#F66666" p-id="4390"></path></svg>
                        {% elif stat.icon == 'cough' %}
                          <svg t="1766814571378" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7006" width="32" height="32"><path d="M420.896 135.04c106.464-37.12 210.944-33.408 310.592 10.88v0.064c105.44 46.848 163.68 157.024 141.568 268a425.6 425.6 0 0 1-25.6 81.472l-1.504 3.008c-9.92 17.472-20.032 32.32-28.96 45.376-27.968 40.96-46.464 67.968-39.52 143.744 5.536 60.512 11.84 120.992 18.88 181.312a40.544 40.544 0 0 1-23.936 41.856 41.184 41.184 0 0 1-16.8 3.552h-267.232a40.8 40.8 0 0 1-40.544-46.848c7.2-46.656 1.696-70.528-2.432-75.744h-0.224c-55.872 1.504-112.128 0.064-114.72 0l-28.096-0.736 0.128-151.424c0.032-6.528-2.944-32.96-53.76-42.496A35.04 35.04 0 0 1 224 578.688a34.72 34.72 0 0 1-0.448-30.72c18.08-38.016 43.84-106.272 54.048-133.888a30.816 30.816 0 0 0 1.92-12.48c-2.72-49.152-0.64-213.6 140.864-266.368l0.544-0.192zM268.832 829.184c2.656 0.32 5.248 0.96 7.744 1.984l2.4 1.12a21.76 21.76 0 0 1 4.48 3.04l1.024 0.896 0.96 0.96 0.96 1.024 0.864 1.024a26.048 26.048 0 0 1 4.064 7.072l0.832 2.56c0.544 1.728 0.896 3.52 1.088 5.312l0.064 1.408v2.72l-0.064 1.408c-0.32 2.72-0.96 5.376-1.92 7.904l-1.152 2.464a22.176 22.176 0 0 1-1.376 2.4c-0.448 0.736-1.056 1.504-1.536 2.24-0.32 0.32-0.576 0.704-0.864 1.024l-0.96 0.992-1.984 1.888a25.504 25.504 0 0 1-6.88 4.096 26.144 26.144 0 0 1-7.744 2.016l-1.28 0.096h-2.72l-1.28-0.096a27.072 27.072 0 0 1-7.776-1.984l-2.4-1.088a16.512 16.512 0 0 1-2.24-1.44c-0.768-0.48-1.504-1.12-2.208-1.6l-1.024-0.96a19.104 19.104 0 0 1-1.888-1.92l-0.896-1.024a26.144 26.144 0 0 1-4-7.104 26.56 26.56 0 0 1-1.92-7.904l-0.128-1.408v-2.72a28.032 28.032 0 0 1 4.48-14.144l1.6-2.24a26.784 26.784 0 0 1 1.792-2.048l0.96-0.96a20.448 20.448 0 0 1 3.2-2.496 31.968 31.968 0 0 1 4.672-2.56 25.44 25.44 0 0 1 7.744-1.92l1.312-0.16a25.088 25.088 0 0 1 2.688 0l1.312 0.128z m413.984-298.08a28.8 28.8 0 0 0-29.248 12.576c-9.984 15.552-30.496 36.608-70.336 43.52-39.616-48.928-114.688-70.24-181.632-46.784a200.864 200.864 0 0 0-50.208 24.576 27.36 27.36 0 0 0-11.584 19.84 27.168 27.168 0 0 0 7.712 21.536l1.888 1.984a27.84 27.84 0 0 0 35.616 3.008 148.672 148.672 0 0 1 35.776-17.056c50.112-17.6 111.104 4.448 128 46.176 31.936 79.232 29.056 155.776 24.832 193.024a26.56 26.56 0 0 0 20.8 28.928l3.648 0.832a27.072 27.072 0 0 0 21.504-4.16 26.944 26.944 0 0 0 11.296-18.688c7.776-67.552 0.64-136-20.992-200.512a152.352 152.352 0 0 0 91.84-65.248v-0.032a28.416 28.416 0 0 0-18.912-43.52zM139.712 720.32a30.08 30.08 0 0 1 21.184 8.736 29.76 29.76 0 0 1-21.184 50.912 29.792 29.792 0 1 1 0-59.648z m69.344-24.128c2.656 0.32 5.248 1.024 7.712 2.016 0.832 0.32 1.664 0.768 2.432 1.152 1.6 0.768 3.104 1.792 4.48 2.944l0.992 0.928 0.96 0.96 0.96 0.992c2.08 2.4 3.744 5.12 4.896 8.096l0.896 2.592a27.712 27.712 0 0 1 1.056 5.376l0.096 1.344v2.72a33.024 33.024 0 0 1-2.016 9.312l-1.152 2.464a22.592 22.592 0 0 1-2.88 4.64l-0.928 0.992a23.104 23.104 0 0 1-0.896 1.056l-0.96 0.96a25.12 25.12 0 0 1-7.936 5.088 25.984 25.984 0 0 1-7.712 2.016l-1.344 0.064h-2.656l-1.376-0.096a27.2 27.2 0 0 1-16.544-8l-0.928-1.088a19.456 19.456 0 0 1-2.432-3.2 31.04 31.04 0 0 1-4.416-12.8l-0.096-1.408v-2.72c0-0.448 0-0.896 0.064-1.344a28.48 28.48 0 0 1 3.04-10.432c0.384-0.8 0.928-1.6 1.408-2.304l1.568-2.24 0.864-1.12 0.928-0.96 0.96-0.96 1.024-0.896a25.6 25.6 0 0 1 6.848-4.128 25.312 25.312 0 0 1 7.712-2.016l1.376-0.096h2.656l1.344 0.096z" fill="#5683FF" p-id="7007"></path></svg>
                        {% elif stat.icon == 'appetite' %}
                        <svg t="1766815076167" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18561" width="32" height="32"><path d="M307.8 374.6c20.8 0 37.4-16.8 37.4-37.4 0-18.4 18.2-31 31.4-21.4 9.8 7 22.2 9 33.6 5.4 11.4-3.6 20.4-12.6 24-24 3.6-11.2 18.2-21 29.8-12.6 9.8 7 22.2 9 33.6 5.4 11.4-3.8 20.4-12.6 24-24 2.6-8 9.6-16 19.2-16s16.6 8 19.2 16c3.8 11.4 12.6 20.4 24 24 3 1 6 0.4 9 0.8l-63.8 39.8c-17.6 11-23 34.2-12 51.6 7.2 11.4 19.4 17.6 31.8 17.6 6.8 0 13.6-1.8 19.8-5.6l129.2-80.8c5.4 4.6 9.2 11.6 9.2 20.2 0 1.8-0.2 3.4-0.6 5.2-2.8 15.4 4.4 31 17.8 39 5.8 3.4 11.8 11 11.8 22.2H812c0-27.2-10.8-53-29.2-71.6-1-20.8-8.4-39.6-19.8-55l106.4-66.6c17.6-11 23-34.2 12-51.6-11-17.6-34.2-23-51.6-12l-139.4 87.2c-21.4-18.8-50.4-27.6-78.4-22.6-17.8-20.4-43.2-32.8-70.8-32.8-27.6 0-53 12.4-70.8 32.8-32.2-6-66 6.6-87.4 31.2-5.4-1-11-1.6-16.8-1.6-42.2 0-78.2 28.8-91 68.4-36.8 14-63.2 50.8-63.2 94h75c0-14 9.4-25.2 20.8-25.2zM137 437v37.4c0 150 88.8 279.4 216.2 339.2-16.4 4-28.8 18.2-28.8 35.8 0 20.8 16.8 37.4 37.4 37.4h300c20.8 0 37.4-16.8 37.4-37.4 0-17.6-12.4-31.8-28.8-35.8 127.6-60 216.2-189.2 216.2-339.2v-37.4H137z m418.8 283.4L512 654.6l-43.8 65.6-62.4-41.6 75-112.4c7-10.4 18.6-16.6 31.2-16.6 12.6 0 24.2 6.2 31.2 16.6l75 112.4-62.4 41.8z" p-id="18562" fill="#0a3203"></path></svg>             
                         {% elif stat.icon == 'pain' %}
                         <svg t="1766815206480" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="24817" width="32" height="32"><path d="M482.848 307.328c1.216-1.408 60.288-30.816 105.344-19.104 92.8 34.88 170.016 92 226.464 176 28.576 42.464-40 82.016-68.32 39.936-14.4-21.44-31.136-41.28-49.824-59.072 10.016 23.68 17.856 48.256 23.424 73.376 1.12 5.12 6.144 28.544 6.144 36.608 0.736 105.408 13.664 207.552 44.224 308.608 20.32 67.328-84.672 95.904-104.928 28.928-26.72-88.448-40.896-179.136-45.92-270.912a92.48 92.48 0 0 1-15.872-5.44c-28.48 81.76-39.68 165.92-35.744 253.696 3.168 70.144-105.632 69.824-108.8 0-5.12-114.528 15.36-221.344 56.992-326.592 30.272-0.384 59.52-3.68 84.704-6.816 31.68-4.032 52.192-24.96 52.192-53.44 0-26.336-24.64-57.088-54.848-53.344-40.48 5.088-71.776 6.656-100.544 5.12-3.328-4.352-6.624-8.704-10.24-12.896a107.552 107.552 0 0 1-11.2-15.904 147.84 147.84 0 0 0-22.432 22.656 25.984 25.984 0 0 0-4.8 8.096c1.664 1.344 3.328 1.92 7.68 3.264 8.96 2.784 18.208 5.248 27.52 6.08 35.488 3.008 70.848 0.416 106.048-4.032 15.264-1.92 28.8 9.088 35.392 22.624 3.712 5.696 6.016 12.288 6.016 18.368 0 11.584-5.12 19.04-11.488 23.84-7.36 7.936-18.048 12.8-29.92 14.304-62.464 7.872-176.256 20.608-212.64-48.544-36.224-68.896 46.624-130.464 96.256-161.184 3.072-1.92 6.08-3.2 9.12-4.224z m-51.616 253.952a9.952 9.952 0 0 1 8.384 11.2 9.952 9.952 0 0 1-3.84 6.528c-48.864 36.64-90.88 80.128-121.984 113.952a9.856 9.856 0 0 1-17.152-6.688c0-5.12-0.288-10.56-0.608-15.968a410.24 410.24 0 0 0-55.328 82.048 9.856 9.856 0 0 1-8.832 5.504 9.984 9.984 0 0 1-8.448-4.704 9.92 9.92 0 0 1-0.384-9.6c17.856-35.744 43.68-71.904 74.688-104.64a9.92 9.92 0 0 1 17.024 6.848 294.4 294.4 0 0 0 0.64 16.48c29.504-31.2 66.4-67.52 108.512-99.072a9.92 9.92 0 0 1 7.328-1.888z m-41.28-40.224a5.504 5.504 0 0 1 2.304 8.992 5.568 5.568 0 0 1-1.824 1.28c-30.528 14.72-58.08 33.92-78.624 48.96a5.472 5.472 0 0 1-8.64-5.44c0.576-2.784 1.024-5.76 1.44-8.768a226.624 226.624 0 0 0-38.912 38.752 5.44 5.44 0 0 1-5.408 2.016 5.44 5.44 0 0 1-3.296-8.736 246.272 246.272 0 0 1 51.84-48.928 5.504 5.504 0 0 1 6.176-0.16 5.536 5.536 0 0 1 2.432 5.664c-0.608 2.88-1.024 5.984-1.44 9.088 19.392-13.824 43.36-29.664 69.664-42.336a5.536 5.536 0 0 1 4.32-0.384z m58.336-82.56c0.192 0.864 0.128 0.96-0.096 0.576a44.48 44.48 0 0 0-0.704 3.52c0.384-2.368 0.768-3.264 1.12-3.52l-0.256-0.736-0.064 0.16z m5.824-312.32a81.056 81.056 0 1 1 0.032 162.144 81.056 81.056 0 0 1 0-162.144z" fill="#5683FF" p-id="24818"></path></svg>
                        {% elif stat.icon == 'sleep' %}
                        <svg t="1766814862906" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9259" width="32" height="32"><path d="M930.89792 568.65792a31.88224 31.88224 0 0 0-36.80256 2.79552 312.89856 312.89856 0 0 1-441.10336-436.96128l0.71168-0.9728a31.98976 31.98976 0 0 0 0.83456-36.52096l-0.512-0.78848a31.8976 31.8976 0 0 0-33.83296-13.46048l-0.384 0.09216a437.98528 437.98528 0 0 0 84.43904 864.10752q7.46496 0.25088 14.91968 0.25088a437.62176 437.62176 0 0 0 427.29472-343.63392l0.11776-0.56832a31.96416 31.96416 0 0 0-14.848-33.83808z m-43.008-411.3408a43.83744 43.83744 0 0 0-41.30816-29.21472h-193.51552a31.06816 31.06816 0 0 0-31.0528 31.09376 31.07328 31.07328 0 0 0 31.0528 31.08864h142.14144l-174.49472 142.38208a43.92448 43.92448 0 0 0-13.6192 48.6912 43.83744 43.83744 0 0 0 41.31328 29.21472h203.00288a31.07328 31.07328 0 0 0 31.05792-31.08864 31.07328 31.07328 0 0 0-31.05792-31.09376h-151.6544l174.49472-142.38208a43.90912 43.90912 0 0 0 13.6192-48.6912z" fill="#5288F5" p-id="9260"></path></svg>
                        {% elif stat.icon == 'psych' %}
                        <svg t="1766814978497" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16273" width="32" height="32"><path d="M505.565612 294.621612m-108.207761 0a108.207761 108.207761 0 1 0 216.415522 0 108.207761 108.207761 0 1 0-216.415522 0Z" fill="#FD6566" p-id="16274"></path><path d="M614.323582 222.116299c-8.085015-15.176597 2.705194-92.817194 76.417911-30.628299 73.666866 62.204179 127.327522 122.941134 122.910567 156.274627-4.401672 33.302925-139.584955 157.955821-139.584956 157.955821l0.443224 238.225194H345.133851L344.935164 504.969552S199.206209 380.790448 202.629731 345.531224c3.408239-35.24394 118.035104-150.848955 136.635224-168.241672 18.615403-17.392716 79.596896-8.558806 68.103642 35.763582-11.493254 44.337672-96.745075 109.736119-95.766925 131.270687 0.978149 21.549851 71.496597 82.531343 71.496597 82.531343h243.513313s72.826269-59.667104 76.479045-75.577313c3.71391-15.940776-8.925612-31.927403-8.925612-31.927403s-71.741134-82.057552-79.841433-97.234149z m-78.695164-82.225672l34.281075-43.726328-39.50806-24.820538L583.29791 6.021731l-15.986626 57.802508 35.901134 22.222328-67.584 53.859343z m64.649552-1.604776L656.796657 88.644776l-26.440597-35.916418L728.629493 2.445373l-44.077851 63.65612 20.556418 40.822447-104.799523 31.361911z" fill="#FD6566" p-id="16275"></path><path d="M409.936239 472.308537a64.924657 64.924657 0 0 1 64.924657 64.924657v416.630448a64.924657 64.924657 0 1 1-129.849314 0v-416.630448a64.924657 64.924657 0 0 1 64.924657-64.924657zM609.570388 472.308537a64.924657 64.924657 0 0 1 64.93994 64.924657v416.630448a64.924657 64.924657 0 1 1-129.864597 0v-416.630448a64.924657 64.924657 0 0 1 64.924657-64.924657z" fill="#FD6566" p-id="16276"></path></svg>
                        {% elif stat.icon == 'anxiety' %}
                        <svg t="1767237007553" class="icon w-6 h-6" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3824" width="48" height="48"><path d="M512 486.4m-121.6 0a121.6 121.6 0 1 0 243.2 0 121.6 121.6 0 1 0-243.2 0Z" fill="#06C1B6" p-id="3825"></path><path d="M889.6 640c-17.066667-59.733333-98.133333-149.333333-147.2-196.266667-17.066667-17.066667-44.8-21.333333-64-8.533333-23.466667 14.933333-27.733333 46.933333-12.8 70.4l115.2 160c-57.6-8.533333-198.4-10.666667-256-12.8h-25.6c-57.6 0-198.4 2.133333-256 12.8l113.066667-157.866667c12.8-19.2 14.933333-44.8 0-61.866666-19.2-23.466667-53.333333-23.466667-72.533334-4.266667-46.933333 46.933333-132.266667 138.666667-149.333333 198.4-23.466667 85.333333 12.8 121.6 121.6 121.6h85.333333v102.4c0 23.466667 19.2 42.666667 42.666667 42.666667h256c23.466667 0 42.666667-19.2 42.666667-42.666667v-102.4h85.333333c108.8 0 145.066667-36.266667 121.6-121.6zM381.866667 347.733333s-23.466667-85.333333-98.133334-85.333333-72.533333 72.533333-12.8 72.533333 85.333333 0 98.133334 12.8c12.8 12.8 12.8 0 12.8 0zM439.466667 309.333333s4.266667-46.933333-21.333334-66.133333c-29.866667-23.466667-51.2 19.2-23.466666 32 23.466667 12.8 38.4 23.466667 40.533333 32s4.266667 2.133333 4.266667 2.133333zM627.2 347.733333s23.466667-85.333333 98.133333-85.333333 72.533333 72.533333 12.8 72.533333-85.333333 0-98.133333 12.8c-12.8 12.8-12.8 0-12.8 0zM569.6 309.333333s-10.666667-51.2 21.333333-66.133333c34.133333-14.933333 51.2 23.466667 23.466667 36.266667-27.733333 12.8-38.4 19.2-40.533333 27.733333 0 8.533333-4.266667 2.133333-4.266667 2.133333zM497.066667 296.533333s70.4-76.8 29.866666-138.666666-113.066667-14.933333-78.933333 36.266666 46.933333 72.533333 42.666667 91.733334c-6.4 17.066667 6.4 10.666667 6.4 10.666666z" fill="#06C1B6" p-id="3826"></path></svg>
                        {% endif %}
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-slate-800 text-base mb-1 " style="max-width: 220px;">{{ stat.title }}</h3>
                        <div class="flex items-center gap-4 text-sm text-slate-500 font-medium">
                            <span>记录：{{ stat.count }}次</span>
                            <div class="flex items-center gap-1">
                               
                                <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                               
                                <span class="text-red-500">异常：{{ stat.abnormal }}次</span>
                            </div>
                        </div>
                    </div>
                </div>

                <button onclick="window.location.href='{% url 'web_doctor:mobile_health_record_detail' %}?type={{ stat.type }}&title={{ stat.title }}&patient_id={{ patient_id|default:'' }}&source=survey_list'" class="bg-blue-600 text-white text-sm font-bold px-3 py-1.5 rounded shadow-sm hover:bg-blue-700 active:scale-95 transition">
                    查看详情
                </button>
            </div>
            {% endfor %}
            {% else %}
            <div class="p-4 text-sm text-slate-500">暂无随访问卷数据</div>
            {% endif %}
        </div>
        </div>
    </div>
</div>
<script>
    function goHomeReplace() {
        var url = "{% url 'web_doctor:mobile_patient_home' patient_id %}";
        window.location.replace(url);
    }

    (function () {
        var select = document.getElementById("servicePackageSelect");
        if (!select) return;
        select.addEventListener("change", function (e) {
            var packageId = e.target.value;
            var url = new URL(window.location.href);
            url.searchParams.set("package_id", packageId);
            window.location.href = url.toString();
        });
    })();

</script>
{% endblock %}
